# Восстановление золота из руды

## Постановка задачи

Подготовить прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. В нашем распоряжении данные с параметрами добычи и очистки.
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Нужно:
- Подготовить данные;
- Провести исследовательский анализ данных;
- Построить и обучить модель.

## Итоги
<br>- Провели преподготовку данных: заполнили пропуски, избавились от выбросов в данных о концентрации металлов.
<br>- Проанализировали: 
<br>     - Отсутсвующие данные в тестовой выборке: значения в основном отсутвуют данные из блока [тип_параметра] - параметры продукта, но так же нет данных у 4 столбцов из того же блока, но уже расчётные характеристики. По условии задачи некоторые параметры замеряются и/или рассчитываются значительно позже.
<br>     - Концентрации металлов на разных этапах очистки: концентрация золота с каждым этапом возрастает, как и должно быть. Концентрация серебра достигает пика после флотации, но потом уменьшается. А концентрация свинца после первой очистки почти не меняется. Также на гистограммах видно выбросы в районе нуля.
<br>- Проверили правильность расчетов эффективности обогащения руды: все верно.
<br>- Сравнили распределение размеров гранул на обучающей и тестовой выборка. После флотации размер гранул уменьшается. Различий hаспределения на тестовой и тренировочной выборках на разных этапах обработки не наблюдается.
<br> - Исследовали суммарную концентрацию всех веществ: к финальному этапу суммарная концентрация веществ увеличивается. В финальном концентрате диапазон значений сужается, т.к. уменьшается процент ненужного сырья. Избавились от аномалий в концентрация, чтобы улучшить наши метрики в будущем.
<br>- Написали функцию рассчитывающую sMAPE и итоговую sMAPE
<br>- На основе этих метрик кросс-валидацией нашли лучшую модель: случайный лес.
<br>- Итоговая sMAPE на обучающей: 8.504274725769676
<br>- Итоговая sMAPE на тестовой: 7.837947872904433
<br>- Проверили на адекватность с помощью DummyRegressor: sMAPE константой модели выше, чем на тестовой. Значит наша модель адекватна.

